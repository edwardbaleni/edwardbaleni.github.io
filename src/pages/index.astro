---
import { getCollection } from "astro:content";
import Container from "@components/Container.astro";
import PageLayout from "@layouts/PageLayout.astro";
import ArrowCard from "@components/ArrowCard.astro";
import Link from "@components/Link.astro";
import { dateRange } from "@lib/utils";
import { SITE, HOME, SOCIALS } from "@consts";
import mainImage from "@assets/LB-Photos-0022.jpg";

const publications = (await getCollection("publications"))
  .filter(pub => !pub.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0,SITE.NUM_POSTS_ON_HOMEPAGE);

const projects = (await getCollection("projects"))
  .filter(project => !project.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0,SITE.NUM_PROJECTS_ON_HOMEPAGE);

const allwork = (await getCollection("work"))
  .sort((a, b) => new Date(b.data.dateStart).valueOf() - new Date(a.data.dateStart).valueOf())
  .slice(0,SITE.NUM_WORKS_ON_HOMEPAGE);

const work = await Promise.all(
  allwork.map(async (item) => {
    const { Content } = await item.render();
    return { ...item, Content };
  })
);

const alleducation = (await getCollection("education"))
  .sort((a, b) => new Date(b.data.dateStart).valueOf() - new Date(a.data.dateStart).valueOf())
  .slice(0,SITE.NUM_EDUCATION_ON_HOMEPAGE);

const education = await Promise.all(
  alleducation.map(async (item) => {
    const { Content } = await item.render();
    return { ...item, Content };
  })
);

---
    <div class="w-full h-2/5 relative mb-1">
      <img src={mainImage.src} alt="A description of theimage" class="w-full h-full object-cover">
    </div>
    
<PageLayout title={HOME.TITLE} description={HOME.DESCRIPTION}>
  <Container>
    <h4 class="animate font-semibold text-black dark:text-white">
      Hi! I'm Edward Baleni <span class="text-xl">ðŸš€</span> 
    </h4>
    <div class="space-y-16">
      <section>
        <article class="space-y-4">
          <p class="animate">
            A data scientist and statistician with a passion for machine learning and its applications in solving real-world problems. My work spans statistical modeling, anomaly detection, and applying data science techniques to diverse domains.
          </p>
          <p class="animate">
            I hold a BSc in Computer Science and Mathematical Statistics, followed by an Honours degree in Statistical Sciences. I've completed a Master of Science in Statistics and Data Science, where my research focuses on anomaly detection systems and computer vision.
          </p>
          <p class="animate">
            Professionally, I've gained experience working with leading technology companies and financial institutions, where I've applied machine learning and statistical techniques to tackle challenging problems. These experiences have helped me develop both technical expertise and practical problem-solving skills.
          </p>
        </article>
      </section>

      <section class="animate space-y-6">
        <div class="flex flex-wrap gap-y-2 items-center justify-between">
          <h5 class="font-semibold text-black dark:text-white">
            Education
          </h5>
          <Link href="/education">
            See all qualifications and skills
          </Link>
        </div>
       <ul class="flex flex-col space-y-4">
          {education.map(entry => (
            <li>
              <div class="text-sm opacity-75">
                {dateRange(entry.data.dateStart, entry.data.dateEnd)}
              </div>
              <div class="font-semibold text-black dark:text-white">
                {entry.data.degree}
              </div>
              <div class="text-sm opacity-75">
                {entry.data.institution}
              </div>
              {/* <article>
                <entry.Content />
              </article> */}
            </li>
          ))}
        </ul>
      </section>
    
      

       
      <section class="animate space-y-6">
        <div class="flex flex-wrap gap-y-2 items-center justify-between">
          <h5 class="font-semibold text-black dark:text-white">
            Research Interests
          </h5>
          <!-- <Link href="/education">
            See all Skills
          </Link> -->
        </div>
        <div class="flex flex-wrap gap-3">
          {HOME.RESEARCH_INTERESTS && HOME.RESEARCH_INTERESTS.map(interest => (
            <div class="rounded-full border border-stone-300 dark:border-stone-700 px-4 py-2 text-sm bg-stone-100 dark:bg-stone-900 text-black dark:text-white shadow-sm transition-all duration-200 hover:bg-stone-200 hover:dark:bg-stone-800 hover:shadow-md hover:-translate-y-0.5">
              {interest}
            </div>
          ))}
        </div>
      </section>

      <section class="animate space-y-6">
        <div class="flex flex-wrap gap-y-2 items-center justify-between">
          <h5 class="font-semibold text-black dark:text-white">
            Latest publications
          </h5>
          <Link href="/publications">
            See all publications and achievements
          </Link>
        </div>
        <ul class="flex flex-col gap-4">
          {publications.map(pub => (
            <li>
              <ArrowCard entry={pub} />
            </li>
          ))}
        </ul>
      </section>

      <section class="animate space-y-6">
        <div class="flex flex-wrap gap-y-2 items-center justify-between">
          <h5 class="font-semibold text-black dark:text-white">
            Work Experience
          </h5>
          <Link href="/work">
            See all work experience
          </Link>
        </div>
        <ul class="flex flex-col space-y-4">
          {work.map(entry => (
            <li>
              <div class="text-sm opacity-75">
                {dateRange(entry.data.dateStart, entry.data.dateEnd)}
              </div>
              <div class="font-semibold text-black dark:text-white">
                {entry.data.company}
              </div>
              <div class="text-sm opacity-75">
                {entry.data.role}
              </div>
              {/* <article>
                <entry.Content />
              </article> */}
            </li>
          ))}
        </ul>
      </section>

      <!-- <section class="animate space-y-6">
        <div class="flex flex-wrap gap-y-2 items-center justify-between">
          <h5 class="font-semibold text-black dark:text-white">
            Recent projects
          </h5>
          <Link href="/projects">
            See more projects
          </Link>
        </div>
        <ul class="flex flex-col gap-4">
          {projects.map(project => (
            <li>
              <ArrowCard entry={project} />
            </li>
          ))}
        </ul>
      </section> -->

      <section class="animate space-y-4">
        <h5 class="font-semibold text-black dark:text-white">
          Let's Connect
        </h5>
        <article>
          <p>
            If you want to get in touch with me about something or just to say hi,
            reach out on social media or send me an email.
          </p>
        </article>
        <ul class="flex flex-wrap gap-2">
          {SOCIALS.map(SOCIAL => (
            <li class="flex gap-x-2 text-nowrap">
              <Link href={SOCIAL.HREF} external aria-label={`${SITE.NAME} on ${SOCIAL.NAME}`}>
                {SOCIAL.NAME}
              </Link>
              {"/"}
            </li>
          ))}
          <li class="line-clamp-1">
            <Link href={`mailto:${SITE.EMAIL}`} aria-label={`Email ${SITE.NAME}`}>
              {SITE.EMAIL}
            </Link>
          </li>
        </ul>
      </section>
    </div>
  </Container>
</PageLayout>

